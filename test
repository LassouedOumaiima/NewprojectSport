package fr.ca.cats.p1354.s3600.svcdem.service;

import fr.ca.cats.p0070.s1889.logging.service.Logger;
import fr.ca.cats.p0070.s1889.logging.service.LoggerService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

/**
 * Classe de service de cryptage pour l'algorithme AES.
 */
@Service
public class AESUtil {

	private static final Logger LOGGER = LoggerService.getLogger(AESUtil.class);
	
	CipherAESGCMService cipherAESGCMService ;

	@Autowired
	public AESUtil(CipherAESGCMService cipherAESGCMService) {
		this.cipherAESGCMService = cipherAESGCMService;
	}

    /**
     * Initialise un cipher et retourne la chaîne de caractère décryptée par le cipher
     * @param text Chaîne de caractères cryptée
     * @return Chaîne de caractères décryptée
     */
    public String decrypt(String text) {
        try {
            return cipherAESGCMService.decrypt(text);
        } catch (Exception e) {
        	LOGGER.error("\n*** Error from AESUtil cannot decrypt the text {}", e.getMessage());
            return "Decryption failed: " + e.getMessage();
        }
    }
}
