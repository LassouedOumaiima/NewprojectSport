@Test
void testStartKafkaWithRecords() {
    // Create mock records
    DemandeSuggestionKey mockKey = mock(DemandeSuggestionKey.class);
    DemandeSuggestionValue mockValue = mock(DemandeSuggestionValue.class);

    ConsumerRecords<DemandeSuggestionKey, DemandeSuggestionValue> mockRecords = new ConsumerRecords<>(
        Map.of(new TopicPartition("test-topic", 0),
            List.of(new ConsumerRecord<>("test-topic", 0, 0, mockKey, mockValue))
        )
    );

    // Configure the mocked KafkaConsumer
    doReturn(kafkaConsumer).when(service).getKafkaConsumer();
    when(kafkaConsumer.poll(any())).thenReturn(mockRecords);

    // Set the consumer to active
    service.setIsActiveLocal(true);

    // Call the method under test
    assertDoesNotThrow(() -> service.startKafka(service));

    // Verify interactions
    verify(kafkaConsumer, atLeastOnce()).poll(any());
    verify(kafkaConsumer, atLeastOnce()).commitSync();
    verify(kafkaConsumer, atLeastOnce()).close();
}
